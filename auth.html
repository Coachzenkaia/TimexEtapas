<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Autorizar TimexEtapas</title>
    <script src="https://p.trellocdn.com/power-up.min.js"></script>
    <style>
      body   { display:flex;justify-content:center;align-items:center;height:100vh;margin:0;font-family:Arial, sans-serif; }
      button { background:#0079bf;color:#fff;border:none;border-radius:4px;padding:10px 18px;font-size:14px;cursor:pointer; }
      button:hover { background:#026aa7; }
    </style>
  </head>
  <body>
    <button id="auth-btn">Autorizar</button>

    <script>
      const API_KEY = '96e6f5f73e3878e9f40bd3d241f8b732';
      const t = TrelloPowerUp.iframe({ appKey: API_KEY, appName: 'TimexEtapas' });

      document.getElementById('auth-btn').addEventListener('click', () => {
        window.Trello.authorize({
          type: 'popup',
          name: 'TimexEtapas',
          scope: { read: true },
          expiration: 'never',
          persist: true,
          success: () => {
            const token = window.Trello.token();
            t.set('member', 'private', 'token', token).then(() => t.closePopup());
          },
          error: () => alert('No se pudo autorizar')
        });
      });
    </script>
  </body>
</html>