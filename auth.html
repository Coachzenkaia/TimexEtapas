<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <script src="https://p.trellocdn.com/power-up.min.js"></script>
    <style>
      body {
        display: flex;
        justify-content: center;
        align-items: center;
        height: 100vh;
        font-family: sans-serif;
      }
      button {
        background-color: #0079bf;
        color: white;
        border: none;
        padding: 10px 20px;
        border-radius: 4px;
        cursor: pointer;
      }
    </style>
  </head>
  <body>
    <button id="auth-btn">Autorizar Power-Up</button>

    <script>
      const APP_KEY = '96e6f5f73e3878e9f40bd3d241f8b732';
      const t = TrelloPowerUp.iframe();

      document.getElementById('auth-btn').addEventListener('click', function () {
        window.Trello.authorize({
          type: 'popup',
          name: 'TimexEtapas',
          scope: {
            read: true,
            write: false,
            account: false,
          },
          expiration: 'never',
          persist: true,
          success: function () {
            const token = Trello.token();
            t.set('member', 'private', 'token', token).then(() => t.closePopup());
          },
          error: function () {
            alert('No se pudo autorizar.');
          }
        });
      });
    </script>
  </body>
</html>
