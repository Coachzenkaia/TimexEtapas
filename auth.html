<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <link rel="stylesheet" href="https://p.trellocdn.com/power-up.min.css">
    <script src="https://p.trellocdn.com/power-up.min.js"></script>
    <style>
        body { text-align: center; padding: 20px; }
        button { font-size: 14px; }
    </style>
</head>
<body>
    <p>Conecta tu cuenta de Trello para continuar.</p>
    <button id="auth-btn" class="mod-primary">Autorizar</button>

    <script>
        const t = window.TrelloPowerUp.iframe();

        document.getElementById('auth-btn').addEventListener('click', function() {
            t.getRestApi()
                .authorize({
                    scope: 'read', // Pedimos permiso de solo lectura
                    expiration: 'never' // El token no expira
                })
                .then(function(token) {
                    // Si la autorizaci√≥n es exitosa, Trello nos da el token.
                    // Lo guardamos de forma privada para el usuario.
                    return t.set('member', 'private', 'token', token);
                })
                .then(function() {
                    // Una vez guardado el token, cerramos este popup.
                    return t.closePopup();
                });
        });
    </script>
</body>
</html>